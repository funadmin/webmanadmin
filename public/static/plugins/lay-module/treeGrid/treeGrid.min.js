layui.config({}).extend({}).define(["laytpl","laypage","layer","form"],function(a){"use strict";var b=layui.$,c=layui.laytpl,d=layui.laypage,e=layui.layer,f=layui.form,g=layui.hint(),h=layui.device(),i={config:{indexName:"lay_table_index",cols:{isCheckName:"lay_is_checked",isRadio:"lay_is_radio",isOpen:"lay_is_open",isShow:"lay_is_show",level:"lay_level",children:"children",isRowCheck:"lay_is_row_check",cheDisabled:"lay_che_disabled",radDisabled:"lay_rad_disabled",iconOpen:"lay_icon_open",iconClose:"lay_icon_close",icon:"lay_icon"},initWidth:{checkbox:48,space:15,numbers:40,radio:48}},cache:{tableId:{data:{list:[],map:{},treeList:[],upIds:[]}},cla:{claIds:{tableId:!0},claObjs:{tableId:{}}},selectcode:{demokey:[{key:{value:""}}]}},index:layui.table?layui.table.index+1e4:0,set:function(a){var c=this;return c.config=b.extend({},c.config,a),c},on:function(a,b){return layui.onevent.call(this,k,a,b)},getClass:function(a){return i.cache.cla.claObjs[a]},pushClass:function(a,b){i.cache.cla.claObjs[a]=b},isCalss:function(a){var b=this.cache.cla.claIds||{};return b.hasOwnProperty(a)||!1},isClassYes:function(a){var b=this.cache.cla.claIds||{};return b[a]||!1},pushClassIds:function(a,b){this.cache.cla.claIds[a]=b},setObj:function(a,b,c){this.obj[a]||(this.obj[a]={}),this.obj[a][b]=c},getObj:function(a,b){return this.obj[a]?this.obj[a][b]:null},getDataList:function(a){return i.cache[a]?i.cache[a].data.list:[]},setDataList:function(a,b){i.cache[a]||(i.cache[a]={}),i.cache[a].data||(i.cache[a].data={}),i.cache[a].data.list||(i.cache[a].data.list=[]),i.cache[a].data.list=b},getDataMap:function(a){return i.cache[a]?i.cache[a].data.map:{}},setDataMap:function(a,b){i.cache[a]||(i.cache[a]={}),i.cache[a].data||(i.cache[a].data={}),i.cache[a].data.map||(i.cache[a].data.map={}),i.cache[a].data.map=b},getDataTreeList:function(a){return i.cache[a]?i.cache[a].data.treeList:[]},setDataTreeList:function(a,b){i.cache[a]||(i.cache[a]={}),i.cache[a].data||(i.cache[a].data={}),i.cache[a].data.treeList||(i.cache[a].data.treeList={}),i.cache[a].data.treeList=b},getDataRootList:function(a){return i.cache[a]?i.cache[a].data.upIds||[]:[]},setDataRootList:function(a,b){i.cache[a]||(i.cache[a]={}),i.cache[a].data||(i.cache[a].data={}),i.cache[a].data.upIds||(i.cache[a].data.upIds=[]),i.cache[a].data.upIds=b},init:function(a,c){c=c||{};var d=this,e=a?b('table[lay-filter="'+a+'"]'):b(l+"[lay-data]"),f="Table element property lay-data configuration item has a syntax error: ";return e.each(function(){var j,k,d=b(this),e=d.attr("lay-data");try{e=new Function("return "+e)()}catch(h){g.error(f+e)}j=[],k=b.extend({elem:this,cols:[],data:[],skin:d.attr("lay-skin"),size:d.attr("lay-size"),even:"string"==typeof d.attr("lay-even")},i.config,c,e),a&&d.hide(),d.find("thead>tr").each(function(a){k.cols[a]=[],b(this).children().each(function(){var i,d=b(this),e=d.attr("lay-data");try{e=new Function("return "+e)()}catch(h){return g.error(f+e)}i=b.extend({title:d.text(),colspan:d.attr("colspan")||0,rowspan:d.attr("rowspan")||0},e),i.colspan<2&&j.push(i),k.cols[a].push(i)})}),d.find("tbody>tr").each(function(a){var c=b(this),d={};c.children("td").each(function(){var e=b(this),f=e.data("field");return f?d[f]=e.html():void 0}),layui.each(j,function(a,b){var e=c.children("td").eq(a);d[b.field]=e.html()}),k.data[a]=d}),i.render(k)}),d},render:function(a){i.pushClassIds(a.id);var b=new Q(a);return j.call(b)},ready:function(a,b){function e(){var f,g,h;a&&(f=i.getClass(a),f&&f.hasOwnProperty("layBody")?(b(f),c=!0):(g=new Date,h=g.getTime()-d.getTime(),1e4>=h&&!c&&setTimeout(e,50)))}var c=!1,d=new Date;a&&b&&setTimeout(e,50)},checkStatus:function(a){var b=0,c=0,d=[],e=i.getDataList(a)||[];return layui.each(e,function(a,e){return e.constructor===Array?(c++,void 0):(e[i.config.cols.isCheckName]&&(b++,d.push(i.clearCacheKey(e))),void 0)}),{data:d,isAll:e.length?b===e.length-c:!1}},setCheckStatus:function(a,b,c){var k,d=null,e=i.getClass(a),h=i.getDataList(a)||[];return e.layBody.find('input[name="'+E+'"]'),b&&c&&(k=c.split(","),k.forEach(function(a){var d,c=null;h.forEach(function(d){var e=d[b]+"",f=a+"";return e==f?(c=d,void 0):void 0}),c&&(d=c[i.config.indexName],e.layBody.find('input[name="'+E+'"][value="'+d+'"]').prop("checked",!0),e.setCheckData(d,!0))}),e.syncCheckAll(),e.renderForm("checkbox")),d},radioStatus:function(a){var b=i.getClass(a),c=null,g=i.getDataList(a)||[],h=b.layBody.find("input[name='"+D+"']:checked").val();return h=parseInt(h),g.forEach(function(a){a[i.config.indexName]==h&&(c=a)}),i.clearCacheKey(c)},setRadioStatus:function(a,b,c){var l,d=i.getClass(a),e=null,k=i.getDataList(a)||[];return b&&c&&(k.forEach(function(a){var d=a[b]+"",f=c+"";return d==f?(e=a,void 0):void 0}),e&&(l=e[i.config.indexName],d.layBody.find("input:radio[name='"+D+"'][value='"+l+"']").prop("checked",!0),f.render("radio"))),e},clearCacheKey:function(a){return a=b.extend({},a),delete a[i.config.cols.isCheckName],delete a[i.config.indexName],a},query:function(a,c){var d=i.getClass(a);d.renderTdCss(),d.config.data&&d.config.data.constructor===Array&&delete d.config.data,d.config=b.extend({},d.config,c),d.pullData(d.page,d.loading())},reload:function(a,c){var d=j.config[a];return c=c||{},d?(c.data&&c.data.constructor===Array&&delete d.data,i.render(b.extend(!0,{},d,c))):g.error("The ID option was not found in the table instance")},addRow:function(a,c,d){var k,l,m,n,o,p,q,r,s,t,u,v,w,e=i.getClass(a),f=e.config,g=[],h=i.getDataTreeList(a),j=i.getDataList(a)||[];e.resetData(d),j.splice(c,0,d),i.kit.restNumbers(j),i.setDataMap(a,e.resetDataMap(j)),f.isTree&&(g=e.treeFindUpData(d),g?(g.children||(g.children=[]),g.children.push(d),d[i.config.cols.level]=g[i.config.cols.level]+1):(d[i.config.cols.level]=1,h.push(d))),k=e.renderTr(d,d[i.config.indexName]),l=k._tds,m=k._tds_l,n=k._tds_r,o='<tr data-index="'+d[i.config.indexName]+'"'+e.renderTrUpids(d)+">"+l.join("")+"</tr>",p='<tr data-index="'+d[i.config.indexName]+'"'+e.renderTrUpids(d)+">"+m.join("")+"</tr>",q='<tr data-index="'+d[i.config.indexName]+'"'+e.renderTrUpids(d)+">"+n.join("")+"</tr>",0==c?(r=e.layBody.find("table tbody"),s=e.layFixLeft.find("table tbody"),t=e.layFixRight.find("table tbody"),b(r).prepend(o),b(s).prepend(p),b(t).prepend(q),e.layBody.find(".layui-none").remove(),e.layFixLeft.find(".layui-none").remove(),e.layFixRight.find(".layui-none").remove()):(u=e.layBody.find("[data-index="+(c-1)+"]"),v=e.layFixLeft.find("[data-index="+(c-1)+"]"),w=e.layFixRight.find("[data-index="+(c-1)+"]"),b(u).after(o),b(v).after(p),b(w).after(q)),e.renderForm(),f.isPage&&e.renderPage(e.config.page.count+1),e.restNumbers(),e.events(),f.isTree&&(e.treeNodeOpen(g,!0),e.renderTreeConvertShowName(g))},delRow:function(a,b){var k,l,m,n,c=i.getClass(a),d=c.config,e=i.getDataList(a),f=[],g={},h=[],j=[];if(c&&b){for(i.kit.isArray(b)?h=b:h[0]=b,h.forEach(function(a){var b=c.treeFindUpData(a);b&&j.push(b)}),f=d.isTree?i.treeFindSonList(c.config.id,h):h,f.forEach(function(a){var d,b=a[i.config.indexName];g[b]=b,d=c.layBody.find('tr[data-index="'+b+'"]'),d.remove()}),c.restNumbers(),k=[],l=0,m=e.length;m>l;l++)n=!0,f.forEach(function(a){a[i.config.indexName]===e[l][i.config.indexName]&&(n=!1)}),n&&k.push(e[l]);i.kit.restNumbers(k),i.setDataList(a,k),i.setDataMap(a,c.resetDataMap(k)),i.setDataTreeList(a,c.resetDataTreeList(k,i.getDataRootList(a))),j.forEach(function(a){c.renderTreeConvertShowName(a)}),d.isPage&&c.renderPage(c.config.page.count-Object.keys(g).length),c.events()}},updateRow:function(a,c){var e,f,g,h,j,k,l,m,n,o,p,d=i.getClass(a);d&&c&&(e=c[d.config.idField],f=i.getDataMap(a),g=f[e],g&&(b.extend(g,c),h=g[i.config.indexName],j=d.renderTr(g,h),k=j._tds,l=j._tds_l,m=j._tds_r,n=d.layBody.find("tr[data-index="+h+"]"),o=d.layFixLeft.find("tr[data-index="+h+"]"),p=d.layFixRight.find("tr[data-index="+h+"]"),b(n).html(k),b(o).html(l),b(p).html(m)))},treeNodeOpen:function(a,b,c){var d=i.getClass(a);d&&b&&d.treeNodeOpen(b,c)},treeOpenAll:function(a,b){var d,c=i.getClass(a);c&&(void 0===b&&(b=!0),d=i.getDataList(a),d&&d.forEach(function(a){c.treeNodeOpen(a,b)}))},treeFindSonList:function(a,b){var d,e,f,c=i.getClass(a);return c&&b?(d=[],e=[],f={},i.kit.isArray(b)?d=b:d[0]=b,d.forEach(function(a){if(a.children.length>0){var b=c.treeFindSonData(a);b.forEach(function(a){f[a[i.config.indexName]]||(e.push(a),f[a[i.config.indexName]]=a[i.config.indexName])})}e.push(a),f[a[i.config.indexName]]=a[i.config.indexName]}),e):[]},treeFindUpDatas:function(a,b){var c=i.getClass(a);return c&&b?c.treeFindUpDatas(b):[]},treeFindUpData:function(a,b){var c=i.getClass(a);return c&&b?c.treeFindUpData(b):[]},treeFindSonIds:function(a,b){var c=[],d=i.treeFindSonList(a,b);return d.forEach(function(){c.push([i.config.indexName])}),c},treeFindSonIdFields:function(a,b){var c=[],d=i.getClass(a),e=i.treeFindSonList(a,b);return e.forEach(function(a){c.push(a[d.config.idField])}),c},treeIconRender:function(a,b){var c=i.getClass(a);return c&&b?c.treeIconRender(b,!1):[]},treeFindRowCheck:function(a){var b=[],c=i.getDataList(a);return c&&c.forEach(function(a){a[i.config.cols.isRowCheck]&&b.push(a)}),b},treeRowCheck:function(a,b){var d,e,c=i.getClass(a);c&&(d=i.getDataList(c.config.id),e=d[b],"tree"==c.config.model&&(d.forEach(function(a){a[i.config.cols.isRowCheck]=!1}),e[i.config.cols.isRowCheck]=!0,c.layBody.find("tr").css("background-color",""),c.getTr(b).css("background-color","#ccc")),"function"==typeof c.config.onClickRow&&c.config.onClickRow(b,e))},kit:{isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},isNumber:function(a){var b=/^\d+(\.\d+)?$/,c=/^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/;return b.test(a)||c.test(a)?!0:!1},restNumbers:function(a){if(a){var b=0;a.forEach(function(a){a[i.config.indexName]=b,b++})}}}},j=function(){var a=this,b=a.config,c=b.id;return c&&(j.config[c]=b),{reload:function(b){a.reload.call(a,b)},config:b}},k="treeGrid",l=".layui-table",o="layui-hide",q="layui-none",r="layui-table-view",s=".layui-table-header",t=".layui-table-body",u=".layui-table-main",v=".layui-table-fixed",w=".layui-table-fixed-l",x=".layui-table-fixed-r",y=".layui-table-tool",z=".layui-table-page",A=".layui-table-sort",B="layui-table-edit",C="layui-table-hover",D="table_radio_",E="layTableCheckbox",F=".layui-table-filter",G="treeId",H="treeUpId",I="treeShowName",K=function(a){var b='{{#if(item2.colspan){}} colspan="{{item2.colspan}}"{{#} if(item2.rowspan){}} rowspan="{{item2.rowspan}}"{{#}}}';return a=a||{},['<table cellspacing="0" cellpadding="0" border="0" class="layui-table" ','{{# if(d.data.skin){ }}lay-skin="{{d.data.skin}}"{{# } }} {{# if(d.data.size){ }}lay-size="{{d.data.size}}"{{# } }} {{# if(d.data.even){ }}lay-even{{# } }}>',"<thead>","{{# layui.each(d.data.cols, function(i1, item1){ }}","<tr>","{{# layui.each(item1, function(i2, item2){ }}",'{{# if(item2.fixed && item2.fixed !== "right"){ left = true; } }}','{{# if(item2.fixed === "right"){ right = true; } }}',function(){return a.fixed&&"right"!==a.fixed?'{{# if(item2.fixed && item2.fixed !== "right"){ }}':"right"===a.fixed?'{{# if(item2.fixed === "right"){ }}':""}(),'<th data-field="{{ item2.field||i2 }}" {{# if(item2.minWidth){ }}data-minwidth="{{item2.minWidth}}"{{# } }} '+b+' {{# if(item2.unresize){ }}data-unresize="true"{{# } }}>','<div class="layui-table-cell laytable-cell-',"{{# if(item2.colspan > 1){ }}","group","{{# } else { }}","{{d.index}}-{{item2.field || i2}}",'{{# if(item2.type !== "normal"){ }}'," laytable-cell-{{ item2.type }}","{{# } }}","{{# } }}",'" {{#if(item2.align){}}align="{{item2.align}}"{{#}}}>','{{# if(item2.type === "checkbox"){ }}','<input type="checkbox" name="layTableCheckbox" lay-skin="primary" lay-filter="layTableAllChoose">',"{{# } else { }}",'<span>{{item2.title||""}}</span>',"{{# if(!(item2.colspan > 1) && item2.sort){ }}",'<span class="layui-table-sort layui-inline"><i class="layui-edge layui-table-sort-asc"></i><i class="layui-edge layui-table-sort-desc"></i></span>',"{{# } }}","{{# } }}","</div>","</th>",a.fixed?"{{# }; }}":"","{{# }); }}","</tr>","{{# }); }}","</thead>","</table>"].join("")},L=function(){},M=['<table cellspacing="0" cellpadding="0" border="0" class="layui-table" ','{{# if(d.data.skin){ }}lay-skin="{{d.data.skin}}"{{# } }} {{# if(d.data.size){ }}lay-size="{{d.data.size}}"{{# } }} {{# if(d.data.even){ }}lay-even{{# } }}>',"<tbody></tbody>","</table>"].join(""),N=['<div class="layui-form layui-border-box {{d.VIEW_CLASS}} {{d.data.id}}" lay-filter="LAY-table-{{d.index}}" style="{{# if(d.data.width){ }}width:{{d.data.width}}px;{{# } }} {{# if(d.data.height){ }}height:{{d.data.height}}px;{{# } }}">',"{{# if(d.data.toolbar){ }}",'<div class="layui-table-tool"></div>',"{{# } }}",'<div class="layui-table-box">',"{{# var left, right; }}",'<div class="layui-table-header">',K(),"</div>",'<div class="layui-table-filter">',L(),"</div>",'<div class="layui-table-body layui-table-main">',M,"</div>","{{# if(left){ }}",'<div class="layui-table-fixed layui-table-fixed-l">','<div class="layui-table-header">',K({fixed:!0}),"</div>",'<div class="layui-table-body">',M,"</div>","</div>","{{# }; }}","{{# if(right){ }}",'<div class="layui-table-fixed layui-table-fixed-r">','<div class="layui-table-header">',K({fixed:"right"}),'<div class="layui-table-mend"></div>',"</div>",'<div class="layui-table-body">',M,"</div>","</div>","{{# }; }}","</div>","{{# if(d.data.isPage){ }}",'<div class="layui-table-page">','<div id="layui-table-page{{d.index}}"></div>',"</div>","{{# } }}","</div>"].join(""),O=b(window),P=b(document),Q=function(a){var c=this;c.index=++i.index,c.config=b.extend({},c.config,i.config,a),c.configFirst=b.extend({},c.config,i.config,a),c.render(),i.pushClass(a.id,c)};Q.prototype.config={init:null,limit:10,loading:!0,cellMinWidth:60,heightRemove:[],text:{none:"无数据"},isFilter:!1,method:"post",radDisabledNum:0,cheDisabledNum:0,branch:["&#xe622;","&#xe624;"],leaf:"&#xe621;",iconOpen:!0,isOpenDefault:!0,parseData:null,onClickRow:null,onDblClickRow:null,onBeforeCheck:null,onCheck:null,onRadio:null,isTree:!0,isPage:!1,height:"100%",model:"",editModel:"click"},Q.prototype.configFirst={},Q.prototype.render=function(){var e,f,g,h,a=this,d=a.config;return d.elem=b(d.elem),d.where=d.where||{},d.id=d.id||d.elem.attr("id"),a.test(),d.request=b.extend({pageName:"page",limitName:"limit"},d.request),d.response=b.extend({statusName:"code",statusCode:0,msgName:"msg",dataName:"data",countName:"count"},d.response),"object"==typeof d.page&&(d.limit=d.page.limit||d.limit,d.limits=d.page.limits||d.limits,a.page=d.page.curr=d.page.curr||1,delete d.page.elem,delete d.page.jump),d.elem[0]?(a.columnWidthInit(),e=d.elem,f=e.next("."+r),g=a.elem=b(c(N).render({VIEW_CLASS:r,data:d,index:a.index})),d.index=a.index,f[0]&&f.remove(),e.after(g),a.renderTdCss(),a.layHeader=g.find(s),a.layMain=g.find(u),a.layBody=g.find(t),a.layFixed=g.find(v),a.layFixLeft=g.find(w),a.layFixRight=g.find(x),a.layTool=g.find(y),a.layPage=g.find(z),a.layFilter=g.find(F),a.layTool.html(c(b(d.toolbar).html()||"").render(d)),d.height&&(a.tableHeight(),a.resizeHeight(),a.renderCss()),d.cols.length>1&&(h=a.layFixed.find(s).find("th"),h.height(a.layHeader.height()-1-parseFloat(h.css("padding-top"))-parseFloat(h.css("padding-bottom")))),d.isFilter&&a.layFilter.html(a.renderFilter()),a.pullData(a.page,a.loading()),a.test(),void 0):a},Q.prototype.initOpts=function(a){var b=this,c=b.config;a.checkbox&&(a.type="checkbox"),a.space&&(a.type="space"),a.type||(a.type="normal"),"normal"!==a.type&&(a.unresize=!0,a.width=a.width||i.config.initWidth[a.type]),c.isFilter&&0!=a.isFilter&&(a.isFilter=!0)},Q.prototype.getParentDivHeight=function(a){var c=b("#"+a).parent().height();return c},Q.prototype.getCols=function(a){var g,b=this,c={},d=b.config.cols[0],e=!1,f=/^[0-9]+.?[0-9]*$/;f.test(a)&&(e=!0);for(g in d)if(e){if(g==parseInt(a))return d[g]}else if(a==d[g].field)return d[g];return c},Q.prototype.getTr=function(a){var b=this,c=b.layBody.find('tr[data-index="'+a+'"]');return c},Q.prototype.getTd=function(a,c){var d=this,e=d.getTr(a),f=b(e).find('td[data-field="'+c+'"]');return f},Q.prototype.reload=function(a){var c=this;c.config.data&&c.config.data.constructor===Array&&delete c.config.data,c.config=b.extend({},c.config,a),c.configFirst=b.extend({},c.config,a),c.render()},Q.prototype.page=1,Q.prototype.restNumbers=function(){var d,e,a=this;a.config,d=a.layBody.find("table tbody tr"),e=0,d.each(function(){b(this).attr("data-index",e),b(this).find(".laytable-cell-numbers p").text(e+1),b(this).data("index",e),e++})},Q.prototype.resetData=function(a){var b=this,c=b.config;c.isTree&&(a.hasOwnProperty(i.config.cols.isOpen)||(a[i.config.cols.isOpen]=c.isOpenDefault),a.hasOwnProperty(i.config.cols.isShow)||(a[i.config.cols.isShow]=c.isOpenDefault?!0:!1)),a.hasOwnProperty(i.config.cols.cheDisabled)||(a[i.config.cols.cheDisabled]=!1),a[i.config.cols.cheDisabled]&&c.cheDisabledNum++,a[i.config.cols.radDisabled]&&c.radDisabledNum++,a.children=[]},Q.prototype.resetDataMap=function(a){var b=this,c=b.config,d=c.idField,e={};return a&&a.forEach(function(a){e[a[d]]=a}),e},Q.prototype.resetDataresetRoot=!0,Q.prototype.resetDataRoot=function(a){var e,f,g,h,j,k,l,b=this,c=b.config;for(c[G],e=c[H],f=i.getDataMap(b.config.id),g=i.cache[c.id].data.upIds||[],h={},i.cache[c.id].data.upIds=[],g=i.cache[c.id].data.upIds,j=0;j<a.length;j++)k=a[j],f[k[e]]||(h[k[e]]||(l=!0,g.forEach(function(a){a===k[e]&&(l=!1)}),l&&g.push(k[e])),h[k[e]]=k[e]);return g},Q.prototype.resetDataTreeList=function(a,b){var c=this,d=c.config,e=d[G],f=d[H],g=[],h=function(b){var d,g,c=[];for(d=0;d<a.length;d++)g=a[d],g[f]===b&&(g.children=h(g[e]),c.push(g));return c};return b.forEach(function(a){var b=h(a);b&&b.forEach(function(a){g.push(a)})}),g},Q.prototype.resetDataTableList=function(a){var f,g,b=this,c=b.config;return c[G],c[H],f=[],g=function(a,b){var c,d;for(c=0;c<a.length;c++)d=a[c],d[i.config.cols.level]=b,f.push(d),d.children&&d.children.length>0&&g(d.children,1+b)},g(a,1),f.forEach(function(a){var c=b.treeFindUpData(a);a[i.config.cols.isShow]=!c||c[i.config.cols.isOpen]&&c[i.config.cols.isShow]?!0:!1}),f},Q.prototype.resetDatas=function(a){var f,g,h,j,k,l,b=this,c=b.config;if(c[G],c[H],f=[],g=[],h=a,j=b.resetDataMap(a),f.push(h),f.push(g),f.push(j),i.setDataList(b.config.id,h),i.setDataTreeList(b.config.id,g),i.setDataMap(b.config.id,j),null==a||a.length<=0)return f;for(k=0;k<a.length;k++)b.resetData(a[k]);return c.isTree&&(h=[],i.setDataList(b.config.id,h),l=i.cache[c.id].data.upIds||[],(l.length<=0||b.resetDataresetRoot)&&(i.cache[c.id].data.upIds=[],l=b.resetDataRoot(a),b.resetDataresetRoot=!1),g=b.resetDataTreeList(a,l),i.setDataTreeList(b.config.id,g),h=b.resetDataTableList(g),i.setDataList(b.config.id,h)),f},Q.prototype.treeFindDataById=function(a){var b=this,c=b.config,d=null,e=i.getDataList(b.key),f=c[G];return e.forEach(function(b){return b[f]==a?(d=b,void 0):void 0}),d},Q.prototype.treeFindUpData=function(a){var b=null,c=this,d=c.config,e=d[H],f=i.getDataMap(c.config.id);return b=f[a[e]]},Q.prototype.treeFindUpDatas=function(a){var e,f,c=this;return c.config,e=[],f=function(a){var b=c.treeFindUpData(a);b&&(e.push(b),f(b))},f(a),e},Q.prototype.treeFindSonData=function(a){function c(a){a.children.length>0&&a.children.forEach(function(a){b.push(a),a.children.length>0&&c(a)})}var b=[];return c(a),b},Q.prototype.treeConvertShowName=function(a){var d,e,b=this;return b.config,d=a.children&&a.children.length>0,e='<div style="float: left;height: 28px;line-height: 28px;padding-left: '+function(){return d?"5px":"21px"}()+'">'+function(){var c,b="<i>";for(c=1;c<a[i.config.cols.level];c++)b+="&nbsp;&nbsp;&nbsp;&nbsp;";return b+="</i>"}()+function(){var c="",e=a[i.config.cols.isOpen]?"&#xe61a;":"&#xe602;";return d?c='<i class="layui-icon layui-tree-head">'+e+"</i>"+b.treeIconRender(a,!0):c+=b.treeIconRender(a,!0),c}()+"</div>"},Q.prototype.treeNodeOpen=function(a,b){var e,f,c=this,d=c.layBody.find('tr[data-index="'+a[i.config.indexName]+'"]');a&&(a[i.config.cols.isOpen]=b,e=function(b){var d,f,g,h;if(b.children&&b.children.length>0)for(d=b.children,f=0;f<d.length;f++)g=d[f],a[i.config.cols.isOpen]?b[i.config.cols.isOpen]&&b[i.config.cols.isShow]&&(h=c.layBody.find('tr[data-index="'+g[i.config.indexName]+'"]'),h.css("display",""),g[i.config.cols.isShow]=!0):(h=c.layBody.find('tr[data-index="'+g[i.config.indexName]+'"]'),h.css("display","none"),g[i.config.cols.isShow]=!1),e(g)},e(a),c.treeIconRender(a,!1),f=d.find(".layui-tree-head"),a[i.config.cols.isOpen]?f.html("&#xe61a;"):f.html("&#xe602;"))},Q.prototype.treeIconRender=function(a,c){var j,k,d=this,e=d.config,f=e.iconOpen,g=a.children&&a.children.length>0,h="";return f?(j=function(){var b='<i class="layui-tree-'+a[e.idField]+'" style="display:inline-block;width: 16px;height: 16px;background:url(';return b+=g?a[i.config.cols.isOpen]?a[i.config.cols.iconOpen]:a[i.config.cols.iconClose]:a[i.config.cols.icon],b+=') 0 0 no-repeat;"></i>'},g?h=a[i.config.cols.iconOpen]||a[i.config.cols.iconClose]?j():'<i class="layui-icon layui-tree-'+a[e.idField]+" layui-tree-"+(a[i.config.cols.isOpen]?"branch":"leaf")+'" '+f+">"+(a[i.config.cols.isOpen]?d.config.branch[1]:d.config.branch[0])+"</i>":a[i.config.cols.icon]?h=j():h+='<i class="layui-icon layui-tree-'+a[e.idField]+' layui-tree-leaf"  '+f+">"+d.config.leaf+"</i>",c?h:(k=d.layBody.find('tr[data-index="'+a[i.config.indexName]+'"]').find("td[data-field="+e[I]+"]").find(".layui-table-cell"),b(k).find("div .layui-tree-"+a[e.idField]).remove(),b(k).find("div").append(h),void 0)):h},Q.prototype.pullData=function(a,c){var k,l,m,n,d=this,f=d.config,g=f.request,h=f.response;d.startTime=(new Date).getTime(),f.url?(k={},k[g.pageName]=a,k[g.limitName]=f.limit,d.filterRulesSet(k),d.sortSet(k),l=b.extend(k,f.where),f.contentType&&0==f.contentType.indexOf("application/json")&&(l=JSON.stringify(l)),b.ajax({type:f.method||"get",url:f.url,data:l,dataType:"json",contentType:f.contentType,headers:f.headers,success:function(b){b[h.dataName]||(b[h.dataName]=[],b[h.statusName]=0,b[h.countName]=0,b[h.msgName]="返回的数据状态异常"),d.resetDataresetRoot=!0,"function"==typeof f.parseData&&(b=f.parseData(b)||b),d.resetDatas(b[h.dataName]),b[h.dataName]=i.getDataList(f.id),b[h.statusName]!=h.statusCode?(d.renderForm(),d.layMain.html('<div class="'+q+'">'+(b[h.msgName]||"返回的数据状态异常")+"</div>")):(d.renderData(b,a,b[h.countName]),f.time=(new Date).getTime()-d.startTime+" ms"),c&&e.close(c),d.events(),"function"==typeof f.done&&f.done(b,a,b[h.countName]),d.renderRowCheck()},error:function(){d.layMain.html('<div class="'+q+'">数据接口请求异常</div>'),d.renderForm(),c&&e.close(c)}})):f.data&&f.data.constructor===Array&&(m={},n=a*f.limit-f.limit,m[h.dataName]=f.data.concat().splice(n,f.limit),d.resetDatas(m[h.dataName]),m[h.countName]=f.data.length,d.renderData(m,a,f.data.length),d.events(),"function"==typeof f.done&&f.done(m,a,m[h.countName]),d.renderRowCheck())},Q.prototype.filterRulesSet=function(a){var b=this;a["filterRules"]=JSON.stringify(b.filterRules())},Q.prototype.filterRules=function(){var a=this,c=[],d=a.layFilter.find("[name^='filter_']");return layui.each(d,function(a,d){if(b(d).val()){var e={field:d.name,op:"like",value:b(d).val(),datatype:"string"};c.push(e)}}),c},Q.prototype.eachCols=function(a){var g,c=b.extend(!0,[],this.config.cols),d=[],e=0,f=this.config.init;layui.each(c,function(a,b){layui.each(b,function(b,g){if(g.colspan>1){var h=0;e++,g.CHILD_COLS=[],layui.each(c[a+1],function(a,b){b.PARENT_COL||h==g.colspan||(b.PARENT_COL=e,g.CHILD_COLS.push(b),h+=b.colspan>1?b.colspan:1)})}g.PARENT_COL||(g.init=f,d.push(g))})}),g=function(b){layui.each(b||d,function(b,c){return c.CHILD_COLS?g(c.CHILD_COLS):(a(b,c),void 0)})},g()},Q.prototype.renderTreeConvertShowName=function(a){var g,h,c=this,d=c.config,e=d.elem;e.next("."+r),g=c.treeConvertShowName(a),h=c.layBody.find('tr[data-index="'+a[i.config.indexName]+'"]').find("td[data-field="+d[I]+"]").find(".layui-table-cell"),b(h).find("div").remove(),b(h).prepend(g)},Q.prototype.renderTdCss=function(){var f,a=this,b=a.config,c=b.elem,d=c.next("."+r),e=a.index+"_"+k+"_td_style";d.find("#"+e).remove(),f='<style id="'+e+'">'+function(){var b="";return layui.each(a.config.cols,function(c,d){layui.each(d,function(c,d){b+=".laytable-cell-"+a.index+"-"+(d.field||c)+"{"+"width:"+(d.width?d.width+"px":"0px")+"}"})}),b}()+"</style>",d.append(f)},Q.prototype.renderTdEdit=function(a,c){var g,h,j,l,m,n,o,p,q,r,s,d=this,e=b(d.getTd(a,c)).last(),f=d.config;if(c=e.data("field"),g=e.data("edit"),a=e.parents("tr").eq(0).data("index"),h=e.find("div.layui-table-cell p").eq(0).text(),j=i.getDataList(d.key)[a],"select"===g){e.data("drop"),l=dl.ui.table.drop.findFieldObj(f.cols[0],c),m=dl.cache.code.get(l.drop),n="",o=m.syscodevaluecache;for(p in o)q="",o[p].scv_value==j[c]&&(q="selected='selected'"),n+="<option "+q+'  value="'+o[p].scv_value+'">'+o[p].scv_show_name+"</option>";r=b('<select class="'+B+'" lay-ignore>'+n+"</select>"),e.find("."+B)[0]||e.append(r)}else s=b('<input class="layui-input '+B+'">'),s[0].value=b.trim(h),e.find("."+B)[0]||e.append(s),s.focus()},Q.prototype.renderCss=function(){var f,a=this,b=a.config,c=b.elem,d=c.next("."+r),e=a.index+"_"+k+"_style";d.find("#"+e).remove(),f='<style id="'+e+'">'+function(){var c=".layui-tree-head{cursor: pointer;}";return c+=".layui-table-view {margin:0;}",b.model&&"tree"==b.model&&(a.layHeader.hide(),a.layFilter.hide(),c+="."+b.id+" .layui-table td,."+b.id+"{border-style: none;padding:0;}",c+="."+b.id+" .layui-table-view .layui-table{width:100%;}"),c}()+"</style>",d.append(f)},Q.prototype.renderTrUpids=function(a){var f,g,b=this,c=b.config,d=c[H];return' upids="'+a["upIds"]+'" ',f=' u_id="'+a[d]+'" ',g=c.isTree?f:""},Q.prototype.renderTd=function(a,d,e,f){var j,k,l,n,o,g=this,h=g.config;return h.primaryKey=h.primaryKey||"id",j=null==a[d.field]?"":String(a[d.field]),k=d.field||f,l=j,g.getColElem(g.layHeader,k),d.primaryKey=d.primaryKey||h.primaryKey,n="",h.isTree&&h.treeShowName==d.field&&(n=g.treeConvertShowName(a)),o=['<td data-field="'+k+'" '+function(){var a=[];return d.edit&&a.push('data-edit="'+d.edit+'"'),d.align&&a.push('align="'+d.align+'"'),d.templet&&a.push('data-content="'+l+'"'),d.toolbar&&a.push('data-off="true"'),d.event&&a.push('lay-event="'+d.event+'"'),d.style&&a.push('style="'+d.style+'"'),d.minWidth&&a.push('data-minwidth="'+d.minWidth+'"'),a.join(" ")}()+">",'<div class="layui-table-cell laytable-cell-'+function(){var a=h.index+"-"+k;return"normal"===d.type?a:a+" laytable-cell-"+d.type}()+'">'+n+'<p style="width: auto;height: 100%;">'+function(){var g,f=b.extend(!0,{LAY_INDEX:e,LAY_COL:d},a);if("checkbox"===d.type)return f[i.config.cols.cheDisabled]?"":'<input type="checkbox" name="'+E+'" value="'+f[i.config.indexName]+'" lay-skin="primary" '+function(){var b=i.config.cols.isCheckName;return d[b]?(a[b]=d[b],d[b]?"checked":""):f[b]?"checked":""}()+">";if("numbers"===d.type)return e;if("drop"===d.type){if(g=dl.ui.table.drop.findFieldObj(h.cols[0],k),g&&g["drop"])return dl.cache.code.get(g.drop),dl.ui.table.drop.findDropLable(g.drop,l)}else if("radio"===d.type)return f[i.config.cols.radDisabled]?"":'<input type="radio" name="'+D+'" '+function(){var b=i.config.cols.isRadio;return d[b]?(a[b]=d[b],d[b]?"checked":""):f[b]?"checked":""}()+' value="'+f[i.config.indexName]+'" title=" ">';return d.toolbar?c(b(d.toolbar).html()||"").render(f):d.templet?function(){return"function"==typeof d.templet?d.templet(f):c(b(d.templet).html()||String(l)).render(f)}():l}(),"</p></div></td>"].join("")},Q.prototype.renderTr=function(a,b){var e,f,g,c=this;return c.config,e=[],f=[],g=[],c.eachCols(function(d,h){var k,i=h.field||d;a[i],h.colspan>1||(k=c.renderTd(a,h,b,d),e.push(k),h.fixed&&"right"!==h.fixed&&f.push(k),"right"===h.fixed&&g.push(k))}),{_tds:e,_tds_l:f,_tds_r:g}},Q.prototype.renderData=function(a,b,c,d){var f=this,g=f.config,h=a[g.response.dataName]||[],j=[],k=[],l=[],m=function(){return!d&&f.sortKey?f.sort(f.sortKey.field,f.sortKey.sort,!0):(layui.each(h,function(a,c){var h,m,n,o,p,q;f.treeFindUpData(c),h="",!c[i.config.cols.isShow]&&g.isTree&&(h="display: none;"),m=[],n=[],o=[],p=a+g.limit*(b-1)+1,0!==c.length&&(d||(c[i.config.indexName]=a),q=f.renderTr(c,p),m=q._tds,n=q._tds_l,o=q._tds_r,j.push('<tr style="'+h+'" data-index="'+a+'" '+f.renderTrUpids(c)+">"+m.join("")+"</tr>"),k.push('<tr style="'+h+'"  data-index="'+a+'">'+n.join("")+"</tr>"),l.push('<tr style="'+h+'"  data-index="'+a+'">'+o.join("")+"</tr>"))}),f.layBody.scrollTop(0),f.layMain.find("."+q).remove(),f.layMain.find("tbody").html(j.join("")),f.layFixLeft.find("tbody").html(k.join("")),f.layFixRight.find("tbody").html(l.join("")),f.renderForm(),f.haveInit?f.scrollPatch():setTimeout(function(){f.scrollPatch()},50),f.haveInit=!0,e.close(f.tipsIndex),void 0)};return f.key=g.id||g.index,i.setDataList(f.key,h),f.layPage[0===h.length&&1==b?"addClass":"removeClass"](o),d?m():0===h.length?(f.renderForm(),f.layFixed.remove(),f.layMain.find("tbody").html(""),f.layMain.find("."+q).remove(),f.layMain.append('<div class="'+q+'">'+(a[g.response.msgName]?a[g.response.msgName]:g.text.none)+"</div>")):(m(),f.renderPage(c),i.pushClassIds(g.id,!0),void 0)},Q.prototype.renderPage=function(a){var c=this,e=c.config;e.isPage&&(e.page=b.extend({elem:"layui-table-page"+e.index,count:a,limit:e.limit,limits:e.limits||[10,15,20,30,40,50,60,70,80,90],groups:3,layout:["prev","page","next","skip","count","limit"],prev:'<i class="layui-icon">&#xe603;</i>',next:'<i class="layui-icon">&#xe602;</i>',jump:function(a,b){b||(c.page=a.curr,e.limit=a.limit,c.pullData(a.curr,c.loading()))}},e.page),e.page.count=a,d.render(e.page))},Q.prototype.renderFilter=function(){var a=this,b=a.config,d=a.index,e=[];return e.push('<form method="post"  id="'+b.id+'_filter_form">'),e.push('<table cellspacing="0" cellpadding="0" border="0" class="layui-table"><thead><tr>'),layui.each(b.cols,function(a,b){layui.each(b,function(a,b){var c=b.field||a,f=b.minWidth?"data-minwidth='"+b.minWidth+"'":"",g=b.colspan?'colspan="'+b.colspan+'"':"",h=b.rowspan?'rowspan="'+b.rowspan+'"':"",i=b.unresize?'data-unresize="true"':"";e.push('<th data-field="'+c+'"'+f+g+h+i+">"),e.push('<div class="layui-table-cell laytable-cell-'+function(){var a="";return b.colspan>1?a="group":(a=d+"-"+c,"normal"!==b.type&&(a+=" laytable-cell-"+b.type)),a}()+'">'),b.isFilter&&b.field?e.push('<input class="layui-input '+B+'" id="filter_'+b.field+'" name="filter_'+b.field+'">'):e.push(""),e.push("</div></th>")})}),e.push("</tr></thead></table>"),e.push("</form>"),e.join("")},Q.prototype.renderRowCheck=function(){var d,a=this,b=a.config;a.index,d=i.getDataList(b.id),d&&d.forEach(function(b){var c=a.layBody.find("tr[data-index="+b[i.config.indexName]+"]");b[i.config.cols.isRowCheck]?c.css("background-color","#ccc"):c.css("background-color","")})},Q.prototype.getColElem=function(a,b){var c=this,d=c.config;return a.eq(0).find(".laytable-cell-"+(d.index+"-"+b)+":eq(0)")},Q.prototype.renderForm=function(a){f.render(a,"LAY-table-"+this.index)},Q.prototype.sortSet=function(a){var b=this,c=[],d=b.config.cols[0];d.forEach(function(a){if(a.sortType){var b={field:a.field,sort:a.sortType};c.push(b)}}),a.sort=JSON.stringify(c)},Q.prototype.sort=function(a,c,d){var h,o,q,f=this,k=f.config;k.elem.attr("lay-filter"),i.getDataList(f.key),"string"==typeof a&&f.layHeader.find("th").each(function(){var e=b(this),f=e.data("field");return f===a?(a=e,h=f,!1):void 0});try{if(h=h||a.data("field"),f.sortKey&&!d&&h===f.sortKey.field&&c===f.sortKey.sort)return;o=f.layHeader.find("th .laytable-cell-"+k.index+"-"+h).find(A),o.attr("lay-sort",c||null),f.layFixed.find("th")}catch(p){return g.error("Table modules: Did not match to field")}q=f.getCols(h),q&&(q.sortType=c)},Q.prototype.loading=function(){var a=this,b=a.config;return b.loading&&b.url?e.msg("数据请求中",{icon:16,offset:[a.elem.offset().top+a.elem.height()/2-35-O.scrollTop()+"px",a.elem.offset().left+a.elem.width()/2-90-O.scrollLeft()+"px"],time:-1,anim:-1,fixed:!1}):void 0},Q.prototype.setCheckData=function(a,b){var c=this,e=(c.config,i.getDataList(c.key));
    e[a]&&e[a].constructor!==Array&&(e[a][i.config.cols.isCheckName]=b)},Q.prototype.syncCheckAll=function(){var d,e,f,a=this,b=a.config,c=i.getDataList(a.config.id);c&&(d=!0,e=0,c.forEach(function(b){var c;b[i.config.cols.cheDisabled]||(b[i.config.cols.isCheckName]?(c=a.layBody.find("tr[data-index="+b[i.config.indexName]+"]").find('input[name="'+E+'"]'),c.prop("checked",!0),e++):(d=!1,c=a.layBody.find("tr[data-index="+b[i.config.indexName]+"]").find('input[name="'+E+'"]'),c.prop("checked",!1)))}),d&&(f=a.layHeader.find('input[name="'+E+'"]'),f.prop("checked",!0)),e<c.length-b.cheDisabledNum&&(f=a.layHeader.find('input[name="'+E+'"]'),f.prop("checked",!1)),a.renderForm("checkbox"))},Q.prototype.getCssRule=function(a,b){var c=this,d=c.elem.find("style")[0],e=d.sheet||d.styleSheet||{},f=e.cssRules||e.rules;layui.each(f,function(d,e){return e.selectorText===".laytable-cell-"+c.index+"-"+a?(b(e),!0):void 0})},Q.prototype.test=function(){},Q.prototype.resize=function(){var a=this;a.columnWidthInit(),a.tableHeight(),a.resizeHeight(),a.resizeWidth()},Q.prototype.setArea=function(){var a=this;a.columnWidthInit(),a.tableHeight()},Q.prototype.columnWidthInit=function(){var a=this,b=a.config,c=0,d=0,e=0,f=0,g=b.width||function(){var a=function(c){var d,e;c=c||b.elem.parent(),d=c.width();try{e="none"===c.css("display")}catch(f){}return!c[0]||d&&!e?d:a(c.parent())};return a()}()-17;a.eachCols(function(){c++}),g-=function(){return"line"===b.skin||"nob"===b.skin?2:c+1}(),layui.each(b.cols,function(b,c){layui.each(c,function(b,e){var h;return e?(a.initOpts(e),h=e.width||0,e.colspan>1||(/\d+%$/.test(h)?e.width=h=Math.floor(parseFloat(h)/100*g):(e._is_width_dev||!h)&&(e._is_width_dev=!0,e.width=h=0,d++),f+=h),void 0):(c.splice(b,1),void 0)})}),a.autoColNums=d,g>f&&d&&(e=(g-f)/d),layui.each(b.cols,function(a,c){layui.each(c,function(a,c){var d=c.minWidth||b.cellMinWidth;c.colspan>1||0===c.width&&(c.width=Math.floor(e>=d?e:d))})})},Q.prototype.resizeWidth=function(){var a=this;a.renderTdCss()},Q.prototype.tableHeight=function(){var e,f,g,a=this,c=a.config,d=a.configFirst;i.kit.isNumber(d.height)||(e=0,c.heightRemove&&i.kit.isArray(c.heightRemove)&&(f=c.heightRemove,f.forEach(function(a){var c=i.kit.isNumber(a)?a:b(a).outerHeight(!0);i.kit.isNumber(c)&&(e+=c)})),g=O.height()-e-1,a.fullHeightGap=0,c.height&&/^full-\d+$/.test(c.height)&&(a.fullHeightGap=c.height.split("-")[1]),c.height=g-a.fullHeightGap)},Q.prototype.resizeHeight=function(){var d,e,a=this,b=a.config,c=b.height;135>c&&(c=135),a.elem.css("height",c),e=b.isFilter?76:38,d=parseFloat(c)-("tree"==a.config.model?0:e)-1,b.toolbar&&(d-=a.layTool.outerHeight()),b.isPage&&(d=d-a.layPage.outerHeight()-1),a.layMain.css("height",d)},Q.prototype.getScrollWidth=function(a){var b=0;return a?b=a.offsetWidth-a.clientWidth:(a=document.createElement("div"),a.style.width="100px",a.style.height="100px",a.style.overflowY="scroll",document.body.appendChild(a),b=a.offsetWidth-a.clientWidth,document.body.removeChild(a)),b},Q.prototype.scrollPatch=function(){var h,i,j,k,l,a=this,c=a.layMain.children("table"),d=a.layMain.width()-a.layMain.prop("clientWidth"),e=a.layMain.height()-a.layMain.prop("clientHeight"),f=a.getScrollWidth(a.layMain[0]),g=c.outerWidth()-a.layMain.width();a.autoColNums&&5>g&&!a.scrollPatchWStatus&&(h=a.layHeader.eq(0).find("thead th:last-child"),i=h.data("field"),a.getCssRule(i,function(b){var c=b.style.width||h.outerWidth();b.style.width=parseFloat(c)-f-g+"px",a.layMain.height()-a.layMain.prop("clientHeight")>0&&(b.style.width=parseFloat(b.style.width)-1+"px"),a.scrollPatchWStatus=!0})),d&&e?a.elem.find(".layui-table-patch").length<=0&&(j=b('<th class="layui-table-patch"><div class="layui-table-cell"></div></th>'),j.find("div").css({width:d}),a.layHeader.eq(0).find("thead tr").append(j)):(a.layFilter.eq(0).find(".layui-table-patch").remove(),a.layHeader.eq(0).find(".layui-table-patch").remove()),k=a.layMain.height(),l=k-e,a.layFixed.find(t).css("height",c.height()>l?l:"auto"),a.layFixRight[g>0?"removeClass":"addClass"](o),a.layFixRight.css("right",d-1)},Q.prototype.events=function(){var j,a=this,c=a.config,d=b("body"),f={},g=a.layHeader.find("th"),h=a.layBody.find("tr");h.unbind("click").on("click",function(){var d=b(this).attr("data-index");i.treeRowCheck(a.config.id,d)}),h.unbind("dblclick").on("dblclick",function(){var e=b(this).attr("data-index"),f=i.getDataList(a.config.id),g=f[e];"function"==typeof c.onDblClickRow&&c.onDblClickRow(e,g)}),g.unbind("mousemove").on("mousemove",function(a){var c=b(this),e=c.offset().left,g=a.clientX-e;c.attr("colspan")>1||c.data("unresize")||f.resizeStart||(f.allowResize=c.width()-g<=10,d.css("cursor",f.allowResize?"col-resize":""))}),g.unbind("mouseleave").on("mouseleave",function(){b(this),f.resizeStart||d.css("cursor","")}),g.unbind("mousedown").on("mousedown",function(d){var g,e=b(this);f.allowResize&&(g=e.data("field"),d.preventDefault(),f.resizeStart=!0,f.offset=[d.clientX,d.clientY],a.getCssRule(g,function(a){var b=a.style.width||e.outerWidth();f.rule=a,f.ruleWidth=parseFloat(b),f.minWidth=e.data("minwidth")||c.cellMinWidth}))}),P.unbind("mousemove").on("mousemove",function(b){if(f.resizeStart){if(b.preventDefault(),f.rule){var c=f.ruleWidth+b.clientX-f.offset[0];c<f.minWidth&&(c=f.minWidth),f.rule.style.width=c+"px",e.close(a.tipsIndex)}j=1}}),P.unbind("mouseup").on("mouseup",function(){f.resizeStart&&(f={},d.css("cursor",""),a.scrollPatch()),2===j&&(j=null)}),g.unbind("click").on("click",function(){var f,c=b(this),d=c.find(A),e=d.attr("lay-sort");return d[0]&&1!==j?(f="asc"===e?"desc":"desc"===e?null:"asc",a.sort(c,f,null,!0),i.query(a.key),void 0):j=2}),g.find(A+" .layui-edge ").unbind("click").on("click",function(c){var d=b(this),e=d.index(),f=d.parents("th").eq(0).data("field");layui.stope(c),0===e?a.sort(f,"asc",null,!0):a.sort(f,"desc",null,!0),i.query(a.key)}),a.eventsinitIsRun||(a.eventsinit(),a.eventsinitIsRun=!0),a.layMain.unbind("scroll").on("scroll",function(){var c=b(this),d=c.scrollLeft(),f=c.scrollTop();a.layHeader.scrollLeft(d),a.layFilter.scrollLeft(d),a.layFixed.find(t).scrollTop(f),e.close(a.tipsIndex)}),O.unbind("resize").on("resize",function(){a.resize()})},Q.prototype.eventsinitIsRun=!1,Q.prototype.eventsinit=function(){var a=this,d=a.config,f=".layui-table-cell",g=d.elem.attr("lay-filter");a.layFilter.on("keyup","[name^='filter_']",function(){a.page=1,a.pullData(a.page,a.loading())}),a.layBody.on("mouseenter","tr",function(){var c=b(this),d=c.index();a.layBody.find("tr:eq("+d+")").addClass(C)}),a.layBody.on("mouseleave","tr",function(){var c=b(this),d=c.index();a.layBody.find("tr:eq("+d+")").removeClass(C)}),a.layBody.on("click","td div.layui-table-cell p",function(){var n,c=b(this).parent().parent(),d=c.data("field"),g=c.data("edit"),j=c.parents("tr").eq(0).data("index"),l=(i.getDataList(a.key)[j],c.children(f)),m=a.config;if(e.close(a.tipsIndex),!c.data("off")){if(g&&"click"==m.editModel)return a.renderTdEdit(j,d),void 0;if(n=a.getCols(d),!i.config.initWidth[n["type"]]){if(l.find(".layui-form-switch,.layui-form-checkbox")[0])return;Math.round(l.prop("scrollWidth"))>Math.round(l.outerWidth())&&(a.tipsIndex=e.tips(['<div class="layui-table-tips-main" style="margin-top: -'+(l.height()+16)+"px;"+function(){return"sm"===m.size?"padding: 4px 15px; font-size: 12px;":"lg"===m.size?"padding: 14px 15px;":""}()+'">',l.html(),"</div>",'<i class="layui-icon layui-table-tips-c">&#x1006;</i>'].join(""),l[0],{tips:[3,""],time:-1,anim:-1,maxWidth:h.ios||h.android?300:600,isOutAnim:!1,skin:"layui-table-tips",success:function(a,b){a.find(".layui-table-tips-c").on("click",function(){e.close(b)})}}))}}}),a.layBody.on("dblclick","td div.layui-table-cell p",function(){var l,c=b(this).parent().parent(),d=c.data("field"),g=c.data("edit"),h=c.parents("tr").eq(0).data("index");return i.getDataList(a.key)[h],c.children(f),l=a.config,e.close(a.tipsIndex),c.data("off")?void 0:g&&"dblclick"==l.editModel?(a.renderTdEdit(h,d),void 0):void 0}),a.layBody.on("change","."+B,function(){var c=b(this),d=this.value,e=c.parent().data("field"),f=c.parents("tr").eq(0).data("index"),h=i.getDataList(a.key)[f];h[e]=d,layui.event.call(this,k,"edit("+g+")",{value:d,data:h,field:e})}),a.layBody.on("blur","."+B,function(){var d,m,n,e=b(this),g=e.parent().data("field"),h=e.parents("tr").eq(0).data("index"),j=e.parent().data("edit"),k=i.getDataList(a.key)[h],l=a.config;a.eachCols(function(a,b){b.field==g&&b.templet&&(d=b.templet)}),m="","select"===j?(n=dl.ui.table.drop.findFieldObj(l.cols[0],g),n&&n["drop"]&&(dl.cache.code.get(n.drop),m=dl.ui.table.drop.findDropLable(n.drop,this.value)),e.parent().find(f+" p").html(d?c(b(d).html()||m).render(k):m)):e.parent().find(f+" p").html(d?c(b(d).html()||this.value).render(k):this.value),e.parent().data("content",this.value),e.remove()}),a.elem.on("click",".layui-table-cell",function(){var c=b(this),d=c.parents("tr").eq(0).data("index"),f=(a.config,i.getDataList(a.key)),g=f[d];c.find("i.layui-tree-head").length>0&&(a.treeNodeOpen(g,!g[i.config.cols.isOpen]),a.resize())}),a.elem.on("click",'input[name="'+E+'"]+',function(){var m,n,o,p,c=b(this).prev(),f=(a.layBody.find('input[name="'+E+'"]'),c.parents("tr").eq(0).data("index")),h=c[0].checked,j=i.getDataList(a.config.id)[f],l="layTableAllChoose"===c.attr("lay-filter");l?(m=i.getDataList(a.key),m.forEach(function(b){b[i.config.cols.cheDisabled]||a.setCheckData(b[i.config.indexName],h)})):(a.setCheckData(f,h),d.isTree&&(n=a.treeFindSonData(j),n.forEach(function(b){b[i.config.cols.cheDisabled]||a.setCheckData(b[i.config.indexName],h)}),o=function(b){var c,d;null!=b&&b&&b.children.length>0&&(c=!0,b.children.forEach(function(a){a[i.config.cols.isCheckName]||(c=!1)}),c&&a.setCheckData(b[i.config.indexName],h),d=a.treeFindUpData(b),d&&o(d))},p=a.treeFindUpData(j),o(p))),a.syncCheckAll(),layui.event.call(this,k,"checkbox("+g+")",{checked:h,data:i.getDataList(a.key)?j||{}:{},type:l?"all":"one"}),"function"==typeof d.onCheck&&d.onCheck(j,h,l)}),a.elem.on("click",'input[name="'+D+'"]+',function(){var c=b(this).prev(),e=c.parents("tr").eq(0).data("index"),f=i.getDataList(a.config.id)[e];"function"==typeof d.onRadio&&d.onRadio(f)}),a.layBody.on("click","*[lay-event]",function(){var e=b(this),h=e.parents("tr").eq(0).data("index"),j=a.layBody.find('tr[data-index="'+h+'"]'),l="layui-table-click",n=(i.getDataList(a.key),i.getDataList(a.key)[h]);layui.event.call(this,k,"tool("+g+")",{data:n,event:e.attr("lay-event"),tr:j,del:function(){i.delRow(d.id,n)},update:function(d){d=d||{},layui.each(d,function(d,e){if(d in n){var g,h=j.children('td[data-field="'+d+'"]');n[d]=e,a.eachCols(function(a,b){b.field==d&&b.templet&&(g=b.templet)}),h.children(f).html(g?c(b(g).html()||e).render(n):e),h.data("content",e)}})}}),j.addClass(l).siblings("tr").removeClass(l)})},j.config={},i.init(),a(k,i)});